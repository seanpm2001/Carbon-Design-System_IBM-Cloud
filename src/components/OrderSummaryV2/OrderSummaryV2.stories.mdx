import { Meta, Canvas, Story, ArgsTable } from "@storybook/addon-docs";
import OrderSummaryV2, {
  OrderSummaryV2Container,
  OrderSummaryV2Header,
  OrderSummaryV2Content,
  OrderSummaryV2Footer,
  OrderSummaryV2Details,
  OrderSummaryV2Buttons,
  OrderSummaryV2FooterLinks,
  OrderSummaryV2Footnotes,
  OrderSummaryV2Items,
  OrderSummaryV2Terms,
  OrderSummaryV2Totals,
} from ".";
import "./_styles.scss";
import("./_docs-styles.scss");
import { Dropdown, InlineNotification, Checkbox, Link } from "@carbon/react";

<Meta
  title="Components/OrderSummaryV2"
  component={OrderSummaryV2}
  argTypes={{
    locale: {
      control: { type: "select" },
      options: [
        "de",
        "en",
        "es",
        "fr",
        "it",
        "ja",
        "ko",
        "pt-br",
        "zh-cn",
        "zh-tw",
      ],
      defaultValue: "en",
    },
    children: { control: false },
  }}
  parameters={{ status: { type: "GA" } }}
/>

# OrderSummaryV2

export const Template = (args) => <OrderSummaryV2 {...args} />;

export const DropdownExample = (
  <Dropdown
    label="United States of America"
    ariaLabel="Select a Country"
    size="sm"
    id="order-summary-country-switcher"
    type="inline"
    invalidText="A valid value is required"
    itemToString={(item) => item && item.text}
    items={[
      { id: "EU", text: "Europe" },
      { id: "RU", text: "Russia" },
      { id: "CA", text: "Canada" },
      { id: "US", text: "United States of America" },
    ]}
  />
);

export const SubmitPromoExample = () => (
  <SubmitPromo
    accountId="ADD ACCOUNT ID HERE"
    handleSubmit={function handleSubmit(response) {
      console.log("response", response);
    }}
    mock
  />
);

<Canvas>
  <Story
    name="Demo"
    args={{
      estimateData: {},
      countrySwitcher: DropdownExample,
      totalCost: "$700.00",
      primaryButtonText: "Create",
      subTotalItems: [
        { label: "Subtotal", value: "$30.47", key: "subtotal-item-1" },
        { label: "Discount", value: "$20.47", key: "subtotal-discount-1" },
      ],
      items: [
        {
          name: "Attribute 1",
          value: "$700.00",
          details: [
            { name: "Network SVI-Cloud-1" },
            { name: "Name Frankfurt-XC00" },
            { name: "User IP 172.16.10.1/32" },
            { name: "IBM IP 172.16.10.2/32" },
            { name: "Location NA West - Equinix" },
            { name: "BGP ASN Customer IP 645556" },
          ],
        },
        {
          name: "Attribute Name Again",
          value: "$0.00/GB hour",
          details: [{ name: "Local" }],
        },
      ],
      submitPromoCode: SubmitPromoExample,
      termsText: (
        <a className="cds--link" href="#">
          View Terms and Conditions
        </a>
      ),
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

## Description

OrderSummaryV2 is a component used for showing a user their order on Catalog
provisioning pages. The view is typically comprised of either details about the
offering or a list of items that they will be charged for. The Order Summary has
various views including authenticated, unauthenticated, and upgrade required.
These and other views can be seen in the code examples below.

It is required that every Order Summary includes the `estimateData` to pass
along to the cost estimator.

## Usage

1.  Install the
    [@console/pal](https://github.ibm.com/ibmcloud/pal#how-to-install-and-use)
    library
2.  Import the styles:

    ```js
      @import '@console/pal/Components/Banner/styles';
    ```

3.  Import the component:

    ```js
    import OrderSummaryV2, {
      OrderSummaryV2Container,
      OrderSummaryV2Header,
      OrderSummaryV2Content,
      OrderSummaryV2Footer,
      OrderSummaryV2Details,
      OrderSummaryV2Buttons,
      OrderSummaryV2FooterLinks,
      OrderSummaryV2Footnotes,
      OrderSummaryV2Items,
      OrderSummaryV2Terms,
      OrderSummaryV2Totals,
    } from ".";
    ```

4.  Render the component.

For general component usage review the
[Components Docs](https://pages.github.ibm.com/ibmcloud/pal/development-guidelines/components/overview).

## Other Examples

### Order Summary (user is not logged in)

<Canvas>
  <Story
    name="Demo-user-not-logged-in"
    args={{
      primaryButtonText: "Create",
      loginLink: "/login",
      estimateData: {},
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

### Order Summary with details and terms text

A details view of the order summary may be generated by passing in an array of
details. When rendering the details view the `offeringName` should be passed in.
Each item passed into the details array may contain a `label` and `value`
property to render the meta details about the offering. This includes things
like `Region`, `Plan`, etc. By passing in the `isFree` prop the Order Summary
will render free text to the right of the offering. Removing this propr will
render the `Estimate costs` button. A
[Submit Promo Code](/connected/submit-promo/code) component may be used to apply
prop codes to the offering. Terms text may also be provided to the component to
render a link to terms and conditions. You may use the `primaryButtonText` and
`primaryButtonProps` props to control the state of the primary button. A
`countrySwitcher` prop may take Carbon's
[Dropdown](https://www.carbondesignsystem.com/components/dropdown/code/)
component to render a list of selectable countries to switch currencies. The
Order Summary also includes the ability to pass `estimatorButtonProps` to the
estimator component to track click events.

export const notificationsExample = (
  <InlineNotification
    statusIconDescription="info:"
    iconDescription="describes the close button"
    kind="info"
    notificationType="inline"
    role="alert"
    subtitle="Upgrade to a Pay-as-you-go account and receive a $200 credit."
    title="This plan is not available with your current account type."
  />
);

<Canvas>
  <Story
    name="Demo-with-details"
    args={{
      estimateData: {},
      notifications: notificationsExample,
      countrySwitcher: DropdownExample,
      primaryButtonText: "Create",
      details: [
        {
          title: "Cloud Pak for Integration",
          attributes: [
            { label: "Installation environment", value: "Red Hat OpenShift" },
            { label: "Red Hat OpenShift cluster", value: "" },
            { label: "Project", value: "" },
            { label: "Resource group", value: "Default" },
          ],
        },
        {
          title: "IBM Passport Advantage",
          attributes: [
            {
              label: "Name",
              value:
                "IBM Cloud Pak for Integration Enterprise Edition per Virtual Processor Core License + SW Subscription & Support 12 Months",
            },
            { label: "Owner ID", value: "IBMid-XXXXXXXXXX" },
            { label: "Part number", value: "D20zBLL" },
            { label: "Effective dates", value: "01/01/1970 - 12/31/9999" },
          ],
        },
      ],
      primaryButtonProps: { onClick: () => {} },
      submitPromoCode: SubmitPromoExample,
      termsText: (
        <a className="cds--link" href="#">
          View Terms and Conditions
        </a>
      ),
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

### Order Summary with nested items and terms checkbox

A list of nested items may be generated by passing in an `items` prop to the
Order Summary component. A `totalCost` prop may also be used to render the total
cost of the item. Each `item` may contain a `name`, `quantity`, `value` (cost),
an array of `details` and `accordionText`. If providing an array of details,
each detail may contain a `name` and a boolean value for the `isHidden`
property. If `isHidden` is set to `true` then those details will be hidden
within an accordion. You can use the `accordionText` property on the item to
specify this text. A `termsCheckbox` prop is exposed to allow the user to agree
to terms and conditions or agree to third party service agreements.

export const CurrencyDropdown = (
  <Dropdown
    label="USD"
    ariaLabel="Select a Currency"
    size="sm"
    id="order-summary-currency-switcher"
    type="inline"
    itemToString={(item) => item && item.text}
    items={[
      { id: "US", text: "USD" },
      { id: "EU", text: "EUR" },
    ]}
  />
);

export const CheckBoxExample = (
  <>
    <Checkbox
      id="order-summary-check-box"
      indeterminate={false}
      labelText="I read and agree to the following Third-Party service Agreements:"
    />
    <div
      style={{
        display: "inline-flex",
        flexDirection: "column",
        paddingLeft: "1.65rem",
      }}
    >
      <a className="cds--link" href="#">
        Agreement 1
      </a>
      <a className="cds--link" href="#">
        Agreement 2
      </a>
    </div>
  </>
);

<Canvas>
  <Story
    name="Demo-nested-items"
    args={{
      estimateData: {},
      countrySwitcher: DropdownExample,
      currencySwitcher: CurrencyDropdown,
      termsCheckbox: CheckBoxExample,
      totalCost: "$241.00",
      primaryButtonText: "Create",
      items: [
        {
          name: "Attribute 1",
          value: "$700.00",
          details: [
            { name: "Network SVI-Cloud-1" },
            { name: "Name Frankfurt-XC00" },
            { name: "User IP 172.16.10.1/32" },
            { name: "IBM IP 172.16.10.2/32" },
            { name: "Location NA West - Equinix" },
            { name: "BGP ASN Customer IP 645556" },
          ],
        },
        {
          name: "Attribute Name Again",
          value: "$0.00/GB hour",
          details: [{ name: "Local" }],
        },
      ],
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

### Order Summary with save as quote button

You can use `secondaryButtonText` and `secondaryButtonProps` to create a Save as
Quote button.

<Canvas>
  <Story
    name="Demo-save-btn"
    args={{
      estimateData: {},
      countrySwitcher: DropdownExample,
      totalCost: "$241.00",
      primaryButtonText: "Create",
      secondaryButtonText: "Save as quote",
      secondaryButtonProps: { onClick: () => {} },
      footnotes: "*Some Terms and conditions may apply",
      items: [
        {
          name: "Attribute 1",
          value: "$700.00",
          details: [
            { name: "Network SVI-Cloud-1" },
            { name: "Name Frankfurt-XC00" },
            { name: "User IP 172.16.10.1/32" },
            { name: "IBM IP 172.16.10.2/32" },
            { name: "Location NA West - Equinix" },
            { name: "BGP ASN Customer IP 645556" },
          ],
        },
        {
          name: "Attribute Name Again",
          value: "$0.00/GB hour",
          details: [{ name: "Local" }],
        },
      ],
      submitPromoCode: SubmitPromoExample,
      termsText: (
        <a className="cds--link" href="#">
          View Terms and Conditions
        </a>
      ),
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

### Order Summary with inline notification

You can pass in Carbon's InlineNotification component to the `notification` prop
to show a notification to the user. It is recommended that only one
InlineNotification, be passed in at a time and that the notification is relevant
to the users order or order summary. Other notifications should be presented in
page.

<Canvas>
  <Story
    name="Demo-inline"
    args={{
      estimateData: {},
      primaryButtonText: "Upgrade",
      notifications: (
        <InlineNotification
          statusIconDescription="info:"
          iconDescription="describes the close button"
          kind="info"
          notificationType="inline"
          role="alert"
          subtitle="Upgrade to a Pay-as-you-go account and receive a $200 credit."
          title="This plan is not available with your current account type."
        />
      ),
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

## Order Summary with custom primary button and footnotes

You can change the text of the primary button and props by passing in different
values for `primaryButtonText` and `primaryButtonProps`. This can be helpful for
generating different views, like the upgrade button below.

<Canvas>
  <Story
    name="Demo-footnotes"
    args={{
      estimateData: {},
      countrySwitcher: DropdownExample,
      totalCost: "$241.00",
      primaryButtonText: "Upgrade",
      footnotes: "*Some Terms and conditions may apply",
      items: [
        {
          name: "Attribute 1",
          value: "$700.00",
          details: [
            { name: "Network SVI-Cloud-1" },
            { name: "Name Frankfurt-XC00" },
            { name: "User IP 172.16.10.1/32" },
            { name: "IBM IP 172.16.10.2/32" },
            { name: "Location NA West - Equinix" },
            { name: "BGP ASN Customer IP 645556" },
          ],
        },
        {
          name: "Attribute Name Again",
          value: "$0.00/GB hour",
          details: [{ name: "Local" }],
        },
      ],
      submitPromoCode: SubmitPromoExample,
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

## Props

<ArgsTable of={OrderSummaryV2} />

#### OrderSummaryV2Container props

<ArgsTable of={OrderSummaryV2Container} />

#### OrderSummaryV2Content props

<ArgsTable of={OrderSummaryV2Content} />

#### OrderSummaryV2Header props

<ArgsTable of={OrderSummaryV2Header} />

#### OrderSummaryV2Footer props

<ArgsTable of={OrderSummaryV2Footer} />

#### OrderSummaryV2Details props

<ArgsTable of={OrderSummaryV2Details} />

#### OrderSummaryV2Items props

<ArgsTable of={OrderSummaryV2Items} />

#### OrderSummaryV2Buttons props

<ArgsTable of={OrderSummaryV2Buttons} />

#### OrderSummaryV2Totals props

<ArgsTable of={OrderSummaryV2Totals} />

#### OrderSummaryV2FooterLinks props

<ArgsTable of={OrderSummaryV2FooterLinks} />

#### OrderSummaryV2Footnotes props

<ArgsTable of={OrderSummaryV2Footnotes} />

#### OrderSummaryV2Terms props

<ArgsTable of={OrderSummaryV2Terms} />

## Contributors

- Trevor Wong
